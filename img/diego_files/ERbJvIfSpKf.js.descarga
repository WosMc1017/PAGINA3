;/*FB_PKG_DELIM*/

__d("PolarisSettingsLikeCountRootQuery$Parameters",[],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:"7123916737703718",metadata:{},name:"PolarisSettingsLikeCountRootQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("MAWDbThread",["MAWHexUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWHexUtils").orderPreservingHex(a)+"_"+b}g.craftThreadOrder=a}),98);
__d("MAWDexieTable",["Promise","dexie_maw"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){return(h||(h=b("Promise"))).resolve(a)}function a(a){return a.reduce(function(a,b,c){return a.then(function(a){return b(c).then(function(b){a.push(b);return a})})},m([]))}function e(a){return c("dexie_maw").Promise.all(a)}function f(a){return c("dexie_maw").Promise.PSD[a]}function j(a,b){c("dexie_maw").Promise.PSD[a]=b}function k(a){c("dexie_maw").Promise.PSD[a]=void 0}var l=function(){function a(a,b,d,e){d===void 0&&(d=!0);e=new(c("dexie_maw"))(a,babelHelpers["extends"]({chromeTransactionDurability:"relaxed"},e));b(e);this.name=a;this.stores=e;d&&this.open()}var b=a.prototype;b.open=function(){this.stores.open()};b.close=function(){this.stores.close()};b.transact=function(a,b,c){var d=this;return i(this.stores.transaction(a,b.map(function(a){return d.stores[a]}),function(){return c()}))};babelHelpers.createClass(a,[{key:"tables",get:function(){return this.stores.tables}}]);return a}();function m(a){return c("dexie_maw").Promise.resolve(a)}function n(a){return c("dexie_maw").waitFor(a)}g.DEXIE_MIN_KEY=d("dexie_maw").Dexie.minKey;g.DEXIE_MAX_KEY=d("dexie_maw").Dexie.maxKey;g.undexify=i;g.dexieSequentialAll=a;g.dexieAll=e;g.getDexiePSDItem=f;g.setDexiePSDItem=j;g.clearDexiePSDItem=k;g.DexieTable=l;g.dexieResolve=m;g.dexieExpensiveAwait=n}),98);
__d("MAWDbSchema",["MAWDbMsg","MAWDbThread","MAWDexieTable","MAWFolderTypes","MAWLocalizationType","MAWMsgType","MAWODSProxy","MAWTimeUtils","MAWWaitForBackendSetup","SignalDbTypes","WAJids","WALogger","WAMsg","WAOdsEnums","WAStanzaUtils","WATimeUtils","dexie_maw","gkx","promiseDone","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Duplicate waMsgId found for receipt, number of duplicates: ",""]);h=function(){return a};return a}a={appData:"++appDataId,&externalId",appMeta:"key",browserEncryptionMeta:"++id, &version",chunk:"++chunkId, &hashedPlaintextHash",contacts:"contactJid",existingUsers:"id",ftsBackloggedMessages:"rowId",ftsEncryptionMeta:"key",ftsIndexV3:"++ftsRowId,id,chatId,*prefixes",groupInfo:"groupJid,threadId",identity:"deviceJid",jobs:"++jobId,&uniqKey",media:"++mediaId, &hashedPlaintextHash, *msgIds",messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId",meta:"key",participants:"id,threadId,userJid",pendingReceipts:"id",pendingStanzas:"++rowId,externalIdWithType",personalSenderKeyStatuses:"groupJid",prekey:"keyId",prekeyGeneration:"generationId",reactions:"++rowId,reactionId,externalId,reactToMsgId,threadJid,reactToExternalId",receipts:"msgId",senderKeySessions:"id,groupJid,userJid",session:"id",signedPrekey:"keyId",tasks:"taskName",threads:"++chatId,&jid,threadOrder",unrenderedMessages:"++rowId,externalId,thread,msgId"};b={messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId,unsendMsgContentDeleteTs"};e={messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId,unsendMsgContentDeleteTs,revokedExternalId"};f={isDualSend:"++rowId"};var i={historySyncQRCodeSecretKey:"key"},j={unrenderedMessages:"++rowId,externalId,thread,msgId,messageDeleteForMeTs"},k={messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId,unsendMsgContentDeleteTs,revokedExternalId,threadJid",unrenderedMessages:"++rowId,externalId,thread,msgId,messageDeleteForMeTs,threadJid"},l={groupInvites:"invitedParticipantId, inviterJid"},m={pendingStanzas:"++rowId,externalIdWithType, deleteTs"},n={media:"++mediaId, &hashedPlaintextHash, *msgIds, &objectId, &fbid"},o={dualSendMedia:"++id"},p={xma:"++xmaId, associatedMessageId, faviconMediaId, headerMediaId, targetExpiringAtSec, defaultPreviewMediaId"},q={historySyncQRCodeData:"rowId"},r={xma:"++xmaId, externalId, associatedMessageId, faviconMediaId, headerMediaId, targetExpiringAtSec, defaultPreviewMediaId"},s={dyiBatch:"++batchId"},t={groupInfo:"groupJid,threadId,correspondingOpenThreadKey"},u=null;u={groupInvites:u};var v={groupInvites:"[invitedParticipantId+inviterJid], inviterJid"},w={messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId,unsendMsgContentDeleteTs,revokedExternalId,threadJid,[thread+sortOrderMs]",unrenderedMessages:"++rowId,externalId,thread,msgId,messageDeleteForMeTs,threadJid,[thread+sortOrderMs]"},x={syncActions:"index,collection,actionState,indexMac,action,[modelId+modelType+actionState]"},y={missingKeys:"keyHex"},z={pendingMutations:"++id,action,index,collection"},A={collectionVersions:"++id,&collection"},B={syncKeys:"++id,&keyId,keyEpoch"},C={identity:"deviceJid,userJid"},D={uploadRetryStatus:"[externalId+lastRetryTs], lastRetryTs, traceId"},E={stanzaQueue:"++stanzaQueueId,stanzaId,jid,type"},F={deviceChangeAlerts:"++deviceChangeAlertsId"},G={retroactiveBackupsState:"threadId"},H={threads:"++chatId,&jid,threadOrder,&deduplicationKey"},I={mediaBackup:"++mediaBackupId,&objectId,mediaId,msgId"},J={threads:"++chatId,&jid,threadOrder,&deduplicationKey,&authoritativeThreadKey"},K={stanzaQueue:"++stanzaQueueId,stanzaId,jid,type,[jid+type]"},L={editMsgHistory:"++editMsgHistoryId,originalMsgExternalId,threadJid"},M={ftsBackloggedMessages:null,ftsEncryptionMeta:null,ftsIndexV3:null},N={media:"++mediaId, &hashedPlaintextHash, *msgIds, objectId, fbid"},O={ebRestoreQueue:"++queueId",ebUploadQueue:"++queueId"},P={ebRestoreQueue:"++queueId, uploadStatus, uploadTsSec, [uploadStatus+uploadTsSec]",ebUploadQueue:"++queueId, uploadStatus, uploadTsSec, [uploadStatus+uploadTsSec]"},Q={messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId,unsendMsgContentDeleteTs,revokedExternalId,threadJid,[thread+sortOrderMs],[thread+serverTs]"},R={jobs:null},S={danglingQueue:"++queueId"},T={staleQueue:"++staleQueueId,dbVersion"},U={ebUploadQueue:"++queueId, uploadStatus, uploadTsSec, msgIdKey, offlineThreadingId, backupActionType, [uploadStatus+uploadTsSec], [msgIdKey], [offlineThreadingId+backupActionType]"},V={ftsBackloggedMessages:"rowId",ftsEncryptionMeta:"key",ftsIndexV3:"++ftsRowId,id,chatId,*prefixes"},W={participants:"id,threadId,userJid,[threadJid+userJid]"},X={pendingMessageStanzaQueue:"++pendingMessageStanzaQueueId"},Y={deletedMessages:"++rowId,author,chat,externalId"},Z={ebMsgRanges:"++rangeId, threadJid"},aa={groupInvites:"[invitedParticipantId+inviterJid], inviterJid, [threadJid+inviteeJid]"},ba={receipts:"msgId, &waMsgId"},ca={stanzaQueue:"++stanzaQueueId,stanzaId,jid,type,[jid+type],priority,[jid+priority]"},da={messages:"++rowId,externalId,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId,unsendMsgContentDeleteTs,revokedExternalId,threadJid,[thread+sortOrderMs],[thread+serverTs]"},ea=function(a){var b=function(a){var b;b=(b=a.quote)==null?void 0:b.content;return a.quoteExternalId!=null&&(b==null?void 0:b.media)!=null};return a.messages.where("quoteExternalId").between(d("WAStanzaUtils").toStanzaId("0"),d("WAStanzaUtils").toStanzaId("["),!0,!0).filter(b).toArray()["catch"](function(){return a.messages.filter(b).toArray()}).then(function(b){var c=new Set(b.map(function(a){a=(a=a.quote)==null?void 0:a.content;return a==null?void 0:(a=a.media)==null?void 0:a.plaintextHash}).filter(Boolean)),d=b.map(function(a){a=a.msgId;return a});return a.media.filter(function(a){a=a.plaintextHash;return c.has(a)}).toArray().then(function(b){var c=new Map(b.map(function(a){var b=a.mediaId;a=a.plaintextHash;return[a,b]}));return a.messages.where("msgId").anyOf(d).modify(function(a){var b;b=(b=a.quote)==null?void 0:b.content;a.quote.content.mediaId=c.get(b.media.plaintextHash);delete a.quote.content.media})})})},fa=function(a){return a.groupInfo.toCollection().modify(function(a){typeof a.inviter==="number"&&delete a.inviter})},ga=function(a){return a.meta.get(d("SignalDbTypes").MetaKeysEnum.deviceId).then(function(b){var c;if((b==null?void 0:(c=b.value)==null?void 0:c.deviceId)!=null&&typeof b.value.deviceId!=="number")return a.meta.clear()})},ha=function(a){return a.threads.filter(function(a){return d("WAJids").switchOnMsgrChatJidType(a.jid,{group:function(){return!1},user:function(){return a.oldestMsg!=null}})}).toArray().then(function(b){var c=[];b.forEach(function(a){c.push(a.oldestMsg),c.push(a.newestMsg)});return a.messages.where("msgId").anyOf(c.filter(Boolean)).toArray().then(function(c){var e=new Map(),f=[],g=[];c.forEach(function(a){e.set(a.msgId,a)});b.forEach(function(b){var c=e.get(b.oldestMsg),h=e.get(b.newestMsg);(c==null?void 0:c.type)==="Admin"&&(h==null?void 0:h.type)==="Admin"&&(c.msgId===h.msgId?g.push(b.chatId):f.push(b));return d("MAWDexieTable").dexieAll(f.map(function(b){return a.messages.where("thread").equals(b.chatId).toArray()})).then(function(b){b.forEach(function(a){if(a.length===0)return;var b=a[0].thread;a=a.filter(function(a){return a.type!=="Admin"});if(a.length>0)return;g.push(b)});return d("MAWDexieTable").dexieAll([a.threads.bulkDelete(g),a.messages.where("thread").anyOf(g)["delete"]()])})})})})},ia=function(a){return a.unrenderedMessages.toCollection().modify(function(a){if(a.type===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME){var b=a.messageDeleteForMeTs;a.messageDeleteForMeTs=b}})},ja=function(a){var b=0,e=0,f=c("dexie_maw").currentTransaction;if(f==null)throw c("unrecoverableViolation")("transaction does not exist","messenger_e2ee_web");f.on("complete",function(){c("promiseDone")(d("MAWWaitForBackendSetup").waitForBackendSetup("DB upgrade to V31").then(function(){b>0&&d("MAWODSProxy").odsBumpEntityKey({amount:b,entity:d("WAOdsEnums").Entity.MESSAGE_MISSING_THREAD_JID,key:"fail"}),e>0&&d("MAWODSProxy").odsBumpEntityKey({amount:e,entity:d("WAOdsEnums").Entity.MESSAGE_MISSING,key:"fail"})}))});f.on("complete",function(){b>0&&d("MAWODSProxy").odsBumpEntityKey({amount:b,entity:d("WAOdsEnums").Entity.MESSAGE_MISSING_THREAD_JID,key:"fail"}),e>0&&d("MAWODSProxy").odsBumpEntityKey({amount:e,entity:d("WAOdsEnums").Entity.MESSAGE_MISSING,key:"fail"})});return a.threads.toArray().then(function(c){var f=c.reduce(function(a,b){b!=null&&a.set(b.chatId,b);return a},new Map());return d("MAWDexieTable").dexieAll([a.messages.toCollection().modify(function(a){if(a!=null){var c=f.get(a.thread);c!=null?a.threadJid=c.jid:b+=1}else e+=1}),a.unrenderedMessages.toCollection().modify(function(a){if(a!=null){var c=f.get(a.thread);c!=null?a.threadJid=c.jid:b+=1}else e+=1})])})},ka=function(a){return a.isDualSend.toCollection().modify(function(a){a.version==null&&(a.version=1)})},la=function(a){return a.messages.toCollection().modify(function(a){a.type===d("MAWMsgType").MSG_TYPE.ADMIN&&a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION&&(a.altIndex=d("MAWDbMsg").craftE2eeAdminMsgAltIndex(a.thread))})},ma=function(a){return a.messages.toCollection().modify(function(a){a.sortOrderMs=d("MAWDbMsg").getSortOrderWithFallback(a)})},na=function(a){return a.threads.toCollection().modify(function(a){a.folder==null&&(a.folder=d("MAWFolderTypes").FOLDER_ID.INBOX)})},oa=function(a){return a.messages.toCollection().modify(function(a){a.sortOrderMs=d("MAWDbMsg").getSortOrderWithFallback(a)})},pa=function(a){return a.personalSenderKeyStatuses.toCollection().modify(function(a){a.rotateSenderKey=!0,a.hasSenderKey=new Set()})},qa=function(a){return a.messages.toCollection().modify(function(a){a.type===d("MAWMsgType").MSG_TYPE.ADMIN&&a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE&&a.sortOrderMs!=null&&a.sortOrderMs>0&&(a.sortOrderMs=0)})},ra=function(a){return a.messages.toCollection().modify(function(a){!(a.type===d("MAWMsgType").MSG_TYPE.ADMIN&&(a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE||a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION))&&a.sortOrderMs!=null&&a.sortOrderMs<1661204086&&(a.sortOrderMs=d("MAWDbMsg").getCanonicalTsFromMsg(a)*1e3)})},sa=function(a){return a.threads.filter(function(a){return a.isMigratedLocally===!0&&a.newestMsg!=null}).toArray().then(function(b){var c=b.map(function(a){return a.chatId}),e=new Map();return d("MAWDexieTable").dexieAll(b.map(function(b){return a.messages.where(["thread","sortOrderMs"]).between([b.chatId,0],[b.chatId,Number.MAX_VALUE]).last().then(function(a){a!=null&&e.set(a.thread,a.msgId)})})).then(function(){return a.threads.where("chatId").anyOf(c).modify(function(a){var b=e.get(a.chatId);b!=null&&(a.newestMsg=b)})})})},ta=function(a){return a.identity.toCollection().modify(function(a){a.userJid=d("WAJids").extractUserJid(a.deviceJid)})},ua=function(a){return a.threads.toCollection().modify(function(a){a.lastReadMsgTs!=null&&a.lastReadMsgTs<d("WATimeUtils").MAX_INT&&(a.lastReadMsgTs=d("MAWTimeUtils").ensureValidMillisTime(a.lastReadMsgTs));if(a.newestMsgTs!=null&&a.newestMsgTs<d("WATimeUtils").MAX_INT){var b=d("MAWTimeUtils").ensureValidMillisTime(a.newestMsgTs);a.newestMsgTs=b;b!=null&&(a.threadOrder=d("MAWDbThread").craftThreadOrder(b,a.jid))}})},va=function(a){return a.messages.toCollection().modify(function(a){a.type===d("MAWMsgType").MSG_TYPE.ADMIN&&a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE&&(a.altIndex=d("MAWDbMsg").craftCutoverAdminMsgAltIndex(a.thread))})},wa=function(a){return a.meta.get(d("SignalDbTypes").MetaKeysEnum.fbid).then(function(b){var c;if((b==null?void 0:(c=b.value)==null?void 0:c.fbid)!=null&&b.value.fbid==="0")return a.meta.clear()})},xa=function(a){return a.prekey.filter(function(a){return a.isDeleted===!0})["delete"]()},ya=function(a){return c("gkx")("23905")?a.meta.clear():d("MAWDexieTable").dexieResolve()},za=function(a){return a.participants.toCollection().modify(function(a){var b;if(a==null||((b=a.userJid)==null?void 0:b.indexOf("@msgr@msgr"))===!1)return;a.id=a.id.replace("@msgr@msgr","@msgr");a.userJid=a.userJid.replace("@msgr@msgr","@msgr")}).then(function(){})},Aa=function(a){var b=a.threads.filter(function(a){return a.snippetMsg!=null&&a.snippetMsgTs==null});return b.toArray().then(function(c){var e=c.reduce(function(a,b){b!=null&&b.snippetMsg!=null&&a.set(b.jid,b.snippetMsg);return a},new Map());c=Array.from(e.values());return a.messages.where("msgId").anyOf(c).toArray().then(function(a){var c=a.reduce(function(a,b){b!=null&&b.serverTs!=null&&a.set(b.msgId,b.serverTs);return a},new Map());b.modify(function(a){var b=e.get(a.jid);if(b!=null){b=c.get(b);b!=null&&(a.snippetMsgTs=d("WATimeUtils").castUnixTimeToMillisTime(b))}})})})},$=function(a){return a.threads.toArray().then(function(b){return d("MAWDexieTable").dexieAll(b.map(function(b){return a.participants.where("threadId").equals(b.chatId).modify(function(a){a.threadJid=(a=a.threadJid)!=null?a:b.jid})}))})},Ba=$,Ca=function(a){var b=[];return a.groupInvites.toArray().then(function(c){var d=c.map(function(a){return a.invitedParticipantId});return a.participants.bulkGet(d).then(function(d){d.forEach(function(a,d){if(a==null){a=c[d];b.push(a)}});var e=d.filter(Boolean);return a.groupInvites.bulkPut(c.map(function(a){var c=e.find(function(b){return b.id===a.invitedParticipantId});if(c!=null){a.inviteeJid=c.userJid;a.threadJid=c.threadJid;return babelHelpers["extends"]({},a,{inviteeJid:c.userJid,threadJid:c.threadJid})}else{b.push(a);return a}}))})}).then(function(){return a.groupInvites.bulkDelete(b.map(function(a){return[a.invitedParticipantId,a.inviterJid]}))})},Da=function(a){var b=new Map();return a.receipts.toArray().then(function(c){return d("MAWDexieTable").dexieAll(c.map(function(c){return a.messages.get({msgId:c.msgId}).then(function(e){if(e==null)return a.receipts["delete"](c.msgId).then(function(){});else{var f=d("WAMsg").craftWAMsgIdString({author:e.author,chat:e.threadJid,externalId:e.externalId});if(b.has(f)){var g;g=(g=b.get(f))!=null?g:1;b.set(f,g);d("WALogger").ERROR(h(),g);return a.receipts["delete"](c.msgId).then(function(){})}else{b.set(f,1);return a.receipts.where("msgId").equals(e.msgId).modify(function(a){a.waMsgId=f}).then(function(){})}}})}))})};a=[{schema:a,version:21},{schema:b,version:22},{schema:e,version:23},{schema:f,version:24},{schema:i,version:25},{upgrade:ea,version:26},{upgrade:fa,version:27},{upgrade:ga,version:28},{upgrade:ha,version:29},{schema:j,upgrade:ia,version:30},{schema:k,upgrade:ja,version:31},{schema:l,version:32},{schema:m,version:33},{schema:n,version:34},{schema:o,version:35},{schema:p,version:36},{schema:q,version:37},{schema:r,version:38},{schema:s,version:39},{schema:t,version:40},{schema:u,version:41},{schema:v,version:42},{upgrade:ka,version:43},{upgrade:la,version:44},{schema:w,upgrade:ma,version:45},{upgrade:na,version:46},{upgrade:oa,version:47},{schema:x,version:48},{schema:y,version:49},{schema:z,version:50},{schema:A,version:51},{schema:B,version:52},{upgrade:pa,version:53},{upgrade:qa,version:54},{upgrade:ra,version:55},{upgrade:sa,version:56},{schema:C,upgrade:ta,version:57},{upgrade:ua,version:58},{schema:D,version:59},{upgrade:va,version:60},{schema:E,version:61},{schema:F,version:62},{schema:G,version:63},{schema:H,version:64},{schema:I,version:65},{upgrade:wa,version:66},{schema:J,version:67},{upgrade:xa,version:68},{schema:K,version:69},{schema:L,version:70},{upgrade:ya,version:71},{upgrade:za,version:72},{schema:M,version:73},{schema:N,version:74},{schema:O,version:75},{schema:P,version:77},{schema:Q,version:78},{schema:R,version:79},{schema:S,version:80},{schema:T,version:81},{upgrade:Aa,version:82},{schema:U,version:83},{schema:V,version:84},{schema:W,upgrade:$,version:85},{schema:X,version:86},{upgrade:Ba,version:87},{schema:Y,version:88},{schema:Z,version:89},{schema:aa,upgrade:Ca,version:90},{schema:ba,upgrade:Da,version:91},{schema:ca,version:92},{schema:da,version:93}];b=["messages","unrenderedMessages","groupInfo","meta","identity","prekey","prekeyGeneration","session","signedPrekey","senderKeySessions","receipts","pendingReceipts","threads","contacts","participants","tasks","personalSenderKeyStatuses","appData","appMeta","chunk","mediaBackup","media","reactions","groupInvites","dyiBatch","syncActions","missingKeys","pendingMutations","collectionVersions","syncKeys","deviceChangeAlerts","xma","retroactiveBackupsState","editMsgHistory","deletedMessages","ebMsgRanges"];g.MAW_DB_VERSION_CHANGES=a;g.TABLES_TO_ENCRYPT=b}),98);
__d("MAWGetDbVersion",["justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("justknobx")._("1716")}g.getArmadilloDbVersion=a}),98);
__d("MAWReStoreDbSetup",["asyncToGeneratorRuntime","cr:7057"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield h);a==null?void 0:a.closeDb==null?void 0:a.closeDb();h=null});return i.apply(this,arguments)}function c(){h==null&&(h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield b("cr:7057").createDB());yield a.runInTransaction(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){}),"readwrite");return a})());return h}g.closeDB=a;g.getDB=c}),98);
__d("MAWDbVersion",["MAWCurrentUser","MAWDbSchema","MAWGetDbVersion","MAWIndexedDbMetadata","MAWReStoreDbSetup","MAWRestoreRewriteUtils","Promise","WALogger","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[DB] version is not set in QE"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[DB] current db version: ",", target db version: ",""]);j=function(){return a};return a}function k(a){return d("MAWDbSchema").MAW_DB_VERSION_CHANGES.filter(function(b){var c=b.schema;b=b.version;return b<=a&&c!=null}).reduce(function(a,b){b=b.schema;return Object.assign(a,b)},{})}f=d("MAWGetDbVersion").getArmadilloDbVersion();f=k(Math.min(d("MAWDbSchema").MAW_DB_VERSION_CHANGES[d("MAWDbSchema").MAW_DB_VERSION_CHANGES.length-1].version,f>0?f:Infinity));function l(a,b){var c=b.schema,d=b.upgrade;b=b.version;c!=null&&d!=null?a.version(b).stores(c).upgrade(d):c!=null?a.version(b).stores(c):d!=null?a.version(b).upgrade(d):a.version(b);return b}function m(a,c){return d("MAWRestoreRewriteUtils").isOneDBEnabled()||c?(h||(h=b("Promise"))).resolve(null):new(h||(h=b("Promise")))(function(b){if(!indexedDB){b();return}var c=indexedDB.open(a);c.onsuccess=function(a){a=a.target.result;var c=a==null?void 0:a.version;a==null?void 0:a.close();c!=null?b(c/10):b()};c.onerror=function(){b()}})}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("MAWRestoreRewriteUtils").isOneDBEnabled()||a){a=(yield d("MAWReStoreDbSetup").getDB());return a.getCustomMigrationVersion()}else return(h||(h=b("Promise"))).resolve(null)});return o.apply(this,arguments)}function a(){var a=d("MAWCurrentUser").getID(),b=c("gkx")("23906");if(d("MAWRestoreRewriteUtils").isOneDBEnabled()||b)return n(b);else return m(d("MAWIndexedDbMetadata").dbName(a),!1)}function p(a,b){if(b.upgrade!=null)return!0;a=Object.keys((a==null?void 0:a.schema)||{});b=Object.keys((b==null?void 0:b.schema)||{});a=[].concat(a,b);b=new Set(a);return b.size!==a.length}function q(a){return a.reduce(function(a,b,c){if(c===0)return[babelHelpers["extends"]({},b,{schema:k(b.version)})];c=a[a.length-1];if(p(c,b)){a.push(b);return a}a.splice(a.length-1,1,babelHelpers["extends"]({},c,b,{schema:babelHelpers["extends"]({},c==null?void 0:c.schema,b.schema)}));return a},[])}function e(a,b,c){var e=c!=null?c:d("MAWGetDbVersion").getArmadilloDbVersion==null?void 0:d("MAWGetDbVersion").getArmadilloDbVersion();d("WALogger").LOG(j(),b,e);e==null&&d("WALogger").WARN(i());c=d("MAWDbSchema").MAW_DB_VERSION_CHANGES.filter(function(a){a=a.version;return b==null||a>b}).filter(function(a){a=a.version;return e==null||e>=a});var f=d("MAWDbSchema").MAW_DB_VERSION_CHANGES.filter(function(a){a=a.version;return e==null||e>=a});if(c.length===0||c.length===f.length){f=d("MAWDbSchema").MAW_DB_VERSION_CHANGES[d("MAWDbSchema").MAW_DB_VERSION_CHANGES.length-1].version;f=Math.min(e!=null&&e>0?e:f,f);a.version(f).stores(k(f));return f}f=q(c);var g=0;f.forEach(function(b){g=Math.max((b=l(a,b))!=null?b:0,(b=g)!=null?b:0)});return g}g.CURRENT_MAW_STORES=f;g.getDexieDbVersion=m;g.getRestoreDbVersion=n;g.getDBVersion=a;g.updateDB=e}),98);
__d("MAWSignalIndexedDb",["MAWCurrentUser","MAWErrorObject","MAWExceededStorageQuota","MAWIndexedDbMetadata","MAWQplProxy","MAWTransactionMode","Promise","WALogger","WAWorkerGlobalScope","err","gkx","promiseDone","qex","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SignalDb initialization] upgradeneeded is triggered in another worker. This should not happen."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[JOB] Setting up the jobs database"]);j=function(){return a};return a}var k=null,l=null,m="jobs",n="observations";function o(){return c("qex")._("940")}function p(){if(k==null)throw c("err")("SignalDB IndexDB should've been initialized");return k}function q(){if(l==null)throw c("err")("SignalDB IndexDB should've been initialized");return l.then(function(){return p()})}function a(){return k!=null}var r=[function(a){a=a.target.result;a=a.createObjectStore(m,{autoIncrement:!0,keyPath:"jobId"});a.createIndex("uniqKey","uniqKey")},function(a){a=a.target.result;a.createObjectStore(n,{autoIncrement:!1,keyPath:"id"})},function(a){a=a.target.transaction;d("MAWExceededStorageQuota").listenToQuotaExceededError(a);a=a.objectStore(n);a.createIndex("lastUpdate","lastUpdate",{unique:!1})}];function s(){return c("gkx")("23943")}function e(a,b){b===void 0&&(b=!1);l=null;k=null;return t(a,b).then(function(){return k.version})}function t(a,c){c===void 0&&(c=!1);if(!c&&s())return(h||(h=b("Promise"))).resolve();if(l!=null)return l;if(k!=null)return(h||(h=b("Promise"))).resolve();c=d("MAWCurrentUser").getID();var e=d("MAWIndexedDbMetadata").signalDbName(c),f=(a=(c=a)!=null?c:o())!=null?a:r.length;l=new(h||(h=b("Promise")))(function(a,b){d("WALogger").LOG(j());var c=indexedDB.open(e,f);c.onupgradeneeded=function(a){for(var b=0;b<r.length;b++){var c=r[b],d=b+1;u(a,d)&&c(a)}};c.onsuccess=function(b){var c=b.target.result;c.onversionchange=function(){var a;d("WALogger").ERROR(i());c.close();(a=d("WAWorkerGlobalScope").workerGlobalScope.location)==null?void 0:a.reload==null?void 0:a.reload()};k=c;a()};c.onerror=function(){b(c.error)}});return l}function u(a,b){var c=a.newVersion;a=a.oldVersion;return a<b&&c>=b}function v(a){return a===d("MAWTransactionMode").READWRITE?"readwrite":"readonly"}function f(a,b,e,f){var g=v(b);return function(b){return function(){for(var h=arguments.length,i=new Array(h),j=0;j<h;j++)i[j]=arguments[j];var m=f!=null?d("MAWQplProxy").startQplUserFlow(f):null,n=function f(h){return q().then(function(c){var e=function(b){b=c.transaction(a,b!=null?v(b):g,{durability:"relaxed"});d("MAWExceededStorageQuota").listenToQuotaExceededError(b);return b.objectStore(a)};return b.apply(void 0,[e].concat(i))}).then(function(a){m==null?void 0:m.endSuccess();return a})["catch"](function(b){m==null?void 0:m.endFail("job_transaction_fail");b=d("MAWErrorObject").getErrorObject(b);if((b==null?void 0:b.name)==="InvalidStateError"&&h===1){l=null;k=null;c("promiseDone")(t());return f(h-1)}throw c("unrecoverableViolation")(e+":"+a+" - Error performing transaction in signalDB transactor v2","messenger_e2ee_web",b?{error:b}:{})})};return n(1)}}}g.getSignalDbVersion=o;g.getSignalDB=p;g.isSignalDBInitted=a;g.dbMigrations=r;g.makeSignalDbIgnoringPreviousCreations=e;g.makeSignalDB=t;g.makeSignalMsgrTransactor=f}),98);
__d("PolarisMutedAccountsSettingsRoot.entrypoint",["JSResourceForInteraction","usePolarisSettingsIsElevationV1EnabledQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(a){return{queries:{polarisMutedAccountsSettingsRootQuery:{options:{},parameters:c("usePolarisSettingsIsElevationV1EnabledQuery$Parameters"),variables:{}}}}},root:c("JSResourceForInteraction")("PolarisMutedAccountsSettingsRoot.react").__setRef("PolarisMutedAccountsSettingsRoot.entrypoint")};g["default"]=a}),98);
__d("PolarisSettingsLikeCountRoot.entrypoint",["JSResourceForInteraction","PolarisSettingsLikeCountRootQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(a){return{queries:{PolarisSettingsLikeCountRootQuery:{options:{},parameters:c("PolarisSettingsLikeCountRootQuery$Parameters"),variables:{}}}}},root:c("JSResourceForInteraction")("PolarisSettingsLikeCountRoot.react").__setRef("PolarisSettingsLikeCountRoot.entrypoint")};g["default"]=a}),98);